icd codes dao  dao factory factory diagnosis bean loader diagnosis loader  diagnosis bean loader icd codes dao dao factory factory  this factory  factory  list diagnosis bean get all icd codes db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from icd codes order by code result set rs  ps execute query diagnosis loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   diagnosis bean get icd code string code db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from icd codes where code   ps set string 1 code result set rs  ps execute query rs next diagnosis loader load single rs null  sql exception e  e print stack trace db exception e   db util close connection conn ps   add icd code diagnosis bean diag db exception i trust exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement insert into icd codes code description chronic   values  ps set string 1 diag get icd code ps set string 2 diag get description ps set string 3 diag get classification 1  ps execute update  sql exception e  e print stack trace 1062  e get error code i trust exception error code already exists db exception e   db util close connection conn ps   update code diagnosis bean diag db exception  rows connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement update icd codes set description   chronic   where code   ps set string 1 diag get description ps set string 2 diag get classification ps set string 3 diag get icd code rows  ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps  rows  