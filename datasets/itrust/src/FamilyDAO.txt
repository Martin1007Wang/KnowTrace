family dao  dao factory factory family bean loader family bean loader family dao dao factory factory  this factory  factory  list family member bean get parents long pid db exception  get family members pid parent select p 2 first name as first name p 2 last name as last name p 2 mid as mid   from patients p 1 patients p 2   where p 1 mid and p 1 mother mid p 2 mid or p 1 father mid p 2 mid false  list family member bean get siblings long pid db exception  get family members pid sibling select p 2 first name as first name p 2 last name as last name p 2 mid as mid   from patients p 1 patients p 2   where p 1 mid and p 1 mid p 2 mid   and p 1 mother mid p 2 mother mid and p 2 mother mid 0   or p 1 father mid p 2 father mid and p 1 father mid 0 false  list family member bean get children long pid db exception  get family members pid child select first name last name mid from patients   where mother mid or father mid true  list family member bean get family members long pid string relation string query second param db exception  connection conn  null prepared statement ps  null family bean loader  family bean loader relation  conn  factory get connection ps  conn prepare statement query ps set long 1 pid second param ps set long 2 pid result set rs  ps execute query family bean loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   