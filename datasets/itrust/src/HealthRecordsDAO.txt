health records dao  health records bean loader loader  health records bean loader dao factory factory health records dao dao factory factory  this factory  factory  list health record get all health records long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from personal health information   where patient id order by asofdate desc ps set long 1 mid result set rs rs  ps execute query loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   add health record record db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement insert into personal health information patient id height weight  smoker smoking status blood pressure n blood pressure d cholesterol hdl cholesterol ldl cholesterol tri  hcpid values loader load parameters ps record num inserted  ps execute update num inserted  1  sql exception e  e print stack trace db exception e   db util close connection conn ps   