auth dao  login timeout  15  60  1000 dao factory factory auth dao dao factory factory  this factory  factory  string add user long mid role role string password db exception  connection conn  null prepared statement pstmt  null  conn  factory get connection pstmt  conn prepare statement insert into users mid password role s question s answer values  pstmt set long 1 mid pstmt set string 2 password pstmt set string 3 role to string pstmt set string 4 enter the random password given in your account email string pwd  random password get random password pstmt set string 5 pwd pstmt execute update pwd  sql exception e  e print stack trace db exception e   db util close connection conn pstmt   set security question answer string question string answer mid db exception  connection conn  null prepared statement pstmt  null  conn  factory get connection pstmt  conn prepare statement update users set s question   s answer   where mid   pstmt set string 1 question pstmt set string 2 answer pstmt set long 3 mid pstmt execute update  sql exception e  e print stack trace db exception e   db util close connection conn pstmt   string get user name long mid db exception i trust exception  role role  get user role mid role  hcp pha admin uap er lt factory get personnel dao get name mid patient factory get patient dao get name mid tester string value of mid default i trust exception role   role   not supported   role get user role long mid db exception i trust exception  connection conn  null prepared statement pstmt  null  conn  factory get connection pstmt  conn prepare statement select role from users where mid pstmt set long 1 mid result set rs rs  pstmt execute query rs next  role parse rs get string role   i trust exception user does not exist   sql exception e  e print stack trace db exception e   db util close connection conn pstmt   reset password long mid string password db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement update users set password where mid ps set string 1 password ps set long 2 mid ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps   string get security question long mid i trust exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select s question from users where mid ps set long 1 mid result set r  ps execute query r next r get string s question i trust exception no security question set mid   mid  sql exception e  e print stack trace db exception e   db util close connection conn ps   string get security answer long mid i trust exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select s answer from users where mid ps set long 1 mid result set r  ps execute query r next r get string s answer i trust exception no security answer set mid   mid  sql exception e  e print stack trace db exception e   db util close connection conn ps   record login failure string ip addr db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement update login failures set failure count failure count 1 last failure current timestamp where ip address ps set string 1 ip addr num updated  ps execute update num updated  0 insert login failure row ip addr 1 conn  sql exception e  e print stack trace db exception e   db util close connection conn ps   record reset password failure string ip addr db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement update reset password failures set failurecount failurecount 1 where ipaddress ps set string 1 ip addr num updated  ps execute update num updated  0 insert reset password row ip addr 1 conn  sql exception e  e print stack trace db exception e   db util close connection conn ps   get reset password failures string ip addr db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from reset password failures where ipaddress ps set string 1 ip addr result set rs  ps execute query rs next  system current time millis  rs get timestamp last failure get time  login timeout  update reset failures to zero ip addr conn 0   rs get int failure count    insert reset password row ip addr 0 conn 0   sql exception e  e print stack trace db exception e   db util close connection conn ps   get login failures string ip addr db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from login failures where ipaddress ps set string 1 ip addr result set rs  ps execute query rs next  system current time millis  rs get timestamp last failure get time  login timeout  update failures to zero ip addr conn 0   rs get int failure count    insert login failure row ip addr 0 conn 0   sql exception e  e print stack trace db exception e   db util close connection conn ps   insert login failure row string ip addr failure count connection conn db exception sql exception  prepared statement ps  conn prepare statement insert into login failures ip address failure count values ps set string 1 ip addr ps set int 2 failure count ps execute update  insert reset password row string ip addr failure count connection conn db exception sql exception  prepared statement ps  conn prepare statement insert into reset password failures ip address failure count values ps set string 1 ip addr ps set int 2 failure count ps execute update  update failures to zero string ip addr connection conn db exception sql exception  prepared statement ps  conn prepare statement update login failures set failure count 0 where ip address ps set string 1 ip addr ps execute update  reset login failures to zero string ip addr db exception sql exception  connection conn  null prepared statement ps  null try conn  factory get connection ps  conn prepare statement update login failures set failure count 0 where ip address ps set string 1 ip addr ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps   update reset failures to zero string ip addr connection conn db exception sql exception  prepared statement ps  conn prepare statement update reset password failures set failure count 0 where ip address ps set string 1 ip addr ps execute update  check user exists long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from users where mid ps set long 1 mid result set rs  ps execute query rs next  sql exception e  e print stack trace db exception e   db util close connection conn ps   