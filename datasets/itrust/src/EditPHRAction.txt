edit phr action patient base action  dao factory factory patient dao patient dao allergy dao allergy dao family dao family dao health records dao hr dao office visit dao ov dao icd codes dao icd dao procedures dao proc dao chronic disease mediator disease mediator personnel dao personnel dao personnel bean hcpuap patient bean patient email util emailutil edit phr action dao factory factory logged in mid string pid string i trust exception db exception  super factory pid string this patient dao  factory get patient dao this allergy dao  factory get allergy dao this family dao  factory get family dao this hr dao  factory get health records dao this ov dao  factory get office visit dao this icd dao  factory get icd codes dao this personnel dao  factory get personnel dao this hcpuap  personnel dao get personnel logged in mid this patient  patient dao get patient pid this proc dao  factory get procedures dao emailutil  email util factory this factory  factory  string update allergies long pid string description form validation exception db exception  allergy bean bean  allergy bean bean set description description allergy dao add allergy pid description emailutil send email make email allergy added  patient bean get patient i trust exception  patient dao get patient pid  list allergy bean get allergies i trust exception  allergy dao get allergies pid  list family member bean get family i trust exception  list family member bean fam  array list family member bean list family member bean parents  null parents  family dao get parents pid fam add all parents fam add all family dao get siblings pid fam add all family dao get children pid if parents  null  list family member bean grandparents  array list family member bean for family member bean parent  parents  grandparents add all family dao get parents parent get mid  fam add all grandparents for family member bean gp  grandparents  gp set relation grandparent   fam  list health record get all health records i trust exception  list health record all health records  hr dao get all health records pid all health records  list office visit bean get all office visits i trust exception  ov dao get all office visits pid  office visit bean get complete office visit long visit id i trust exception  ov dao get office visit visit id  list procedure bean get procedures long visit id db exception  proc dao get list visit id  list risk checker get diseases at risk no health records exception i trust exception db exception  this disease mediator  chronic disease mediator factory pid disease mediator get disease at risk  does family member have high bp family member bean member i trust exception  list health record records  hr dao get all health records member get mid if records size  0 false for health record record  records  if record get blood pressure systolic  240  record get blood pressure diastolic  120  true  false  does family member have high cholesterol family member bean member i trust exception  list health record records  hr dao get all health records member get mid if records size  0 false for health record record  records  if record get cholesterol hdl  35  record get cholesterol ldl  250  true  false  does family member have diabetes family member bean member i trust exception  list diagnosis bean diagnoses  patient dao get diagnoses member get mid if diagnoses size  0 false for diagnosis bean diag  diagnoses  if diag get icd code starts with 250 true  false  does family member have cancer family member bean member i trust exception  list diagnosis bean diagnoses  patient dao get diagnoses member get mid if diagnoses size  0 false for diagnosis bean diag  diagnoses  if diag get icd code starts with 199 true  false  does family member have heart disease family member bean member i trust exception  list diagnosis bean diagnoses  patient dao get diagnoses member get mid if diagnoses size  0 false for diagnosis bean diag  diagnoses  if diag get icd code starts with 402 true  false  is family member smoker family member bean member i trust exception  list health record records  hr dao get all health records member get mid if records size  0 false for health record record  records  if record is smoker true  false  string get family member cod family member bean member i trust exception  patient bean patient  patient dao get patient member get mid if patient get cause of death  null  diagnosis bean diag  icd dao get icd code patient get cause of death if diag  null  diag get description  email make email db exception email email  email list patient bean reps  patient dao get representing patient get mid list string to addrs  array list string to addrs add patient get email patient bean r reps  to addrs add r get email  email set from no reply itrust com email set to list to addrs email set subject string format your medical records have been altered email set body health care professional  hcpuap get full name  has altered your medical records   she is not on your list of designated health care professionals email  