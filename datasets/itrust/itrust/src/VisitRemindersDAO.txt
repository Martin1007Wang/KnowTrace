visit reminders dao  dao factory factory visit reminders dao dao factory factory  this factory  factory  list visit reminder return form get patients long hcpid db exception  visit reminder return form temp visit reminder return form loader loader  visit reminder return form loader list visit reminder return form patients  array list visit reminder return form connection conn  null prepared statement ps  null result set rs  null  conn  factory get connection ps  conn prepare statement select distinct    as hid    dhcp patientid    p last name    p first name    p phone 1    p phone 2    p phone 3    from    patients p    declaredhcp dhcp    where    dhcp hcpid      and    p mid  dhcp patientid    and    p dateofdeath is null    and    p dateofbirth  date sub curdate interval 19 year   ps set long 1 hcpid ps set long 2 hcpid rs  ps execute query rs next  temp  loader load single rs patients add temp   sql exception e  e print stack trace db exception e   db util close connection conn ps  patients  list visit reminder return form get diagnosed visit needers long hcpid db exception  connection conn  null prepared statement ps  null result set rs  null  conn  factory get connection ps  conn prepare statement select hid mid last name first name phone 1 phone 2 phone 3 ic dcode visit date from   select distinct     as hid    p mid as mid    p last name    p first name    p phone 1    p phone 2    p phone 3    ovd ic dcode    from    patients p    office visits ov    ov diagnosis ovd    where    p mid  ov patient id    and    p date of death is null    and    ov id  ovd visit id    and       ovd icd code between  and     or    ovd icd code between  and     or    ovd icd code between  and         and    p mid not in        select p mid from patients p office visits ov    where    p mid  ov patient id    and    ov visit date  date sub curdate interval 1 year        a    inner join        select p mid max ov visit date as visit date from patients p office visits ov    where    p mid  ov patient id    group by    p mid     b    using mid   order by    last name first name mid ic dcode  ps set long 1 hcpid ps set float 2 250 0 f ps set float 3 250 99 f ps set float 4 390 0 f ps set float 5 459 99 f ps set float 6 493 0 f ps set float 7 493 99 f rs  ps execute query list visit reminder return form patients  array list visit reminder return form visit reminder return form temp  null visit reminder return form loader loader  visit reminder return form loader last id  1 rs next  last id  rs get long 2  patients get patients size 1 add visit flag new visit flag visit flag diagnosed rs get string 8   last id  rs get long 2 temp  loader load single rs temp add visit flag new visit flag visit flag diagnosed rs get string 8 temp add visit flag new visit flag visit flag last visit rs get string 9 patients add temp   patients  sql exception e  e print stack trace db exception e   db util close connection conn ps   list visit reminder return form get flu shot delinquents long hcpid db exception  connection conn  null prepared statement ps  null result set rs  null this year  date util currently in month range 8 11 string flag type  this year  visit flag missing medication  visit flag missed medication java sql date september  java sql date 0 l december  java sql date 0 l date util set sql month range september 8 this year  0  1 december 11 this year  0  1  conn  factory get connection ps  conn prepare statement select distinct    as hid p mid as patientid p lastname p firstname p phone 1 p phone 2 p phone 3   from office visits ov patients p   where ov patientid p mid   or p mid not in select ov patientid from office visits ov   and p dateofdeath is null   and p dateofbirth  date sub curdate interval 50 year   and p mid not in   select patientid as mid from office visits ov ov procedure op   where ov id op visitid   and cpt code in 90656 90658 90660   and ov visitdate between  and    or ov visitdate between  and    order by lastname firstname p mid ps set long 1 hcpid ps set date 2 september ps set date 3 december ps set date 4 september ps set date 5 december rs  ps execute query list visit reminder return form patients  array list visit reminder return form visit reminder return form temp visit reminder return form loader loader  visit reminder return form loader rs next  temp  loader load single rs temp add visit flag new visit flag flag type flu shot patients add temp  patients  sql exception e  e print stack trace db exception e   db util close connection conn ps   