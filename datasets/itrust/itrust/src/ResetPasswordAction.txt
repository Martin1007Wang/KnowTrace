reset password action  max reset attempts  3 auth dao auth dao patient dao patient dao dao factory factory reset password action dao factory factory  this auth dao  factory get auth dao this patient dao  factory get patient dao this factory  factory  check mid string mid string   mid  long value of mid string auth dao check user exists mid 0 mid  number format exception e  0 l  db exception e  0 l   is maxed out string ip address db exception  auth dao get reset password failures ip address  max reset attempts  string check role long mid string role i trust exception   patient equals role  patient dao get role mid role equals patient  hcp equals role  patient dao get role mid role equals hcp  uap equals role  patient dao get role mid role equals uap  pha equals role  patient dao get role mid role equals pha  er equals role  patient dao get role mid role equals er  lt equals role  patient dao get role mid role equals lt role null  db exception e  e print stack trace  i trust exception e  e print stack trace e  null  string check answer null string answer  answer  null  equals answer null answer  string get security question long mid i trust exception   null  auth dao get security question mid  auth dao get security question mid equals i trust exception no security question or answer user has been set auth dao get security question mid  db exception e  e print stack trace    string reset password long mid string role string answer string password string confirm password string ip addr form validation exception db exception i trust exception  role r  auth dao get user role mid  role parse role  illegal argument exception e  invalid role  r equals role admin this role cannot be changed here r equals role parse role role mismatch auth dao get reset password failures ip addr  max reset attempts  too many retries   validate password password confirm password answer equals auth dao get security answer mid  auth dao reset password mid password email util factory send email make email app mid role password changed   auth dao record reset password failure ip addr answer did not match   db exception e  error in validation of security answer   email make email app long mid string role db exception if role parse role  role patient patient bean p  patient dao factory get patient mid email email  email email set from no reply itrust com email set to list arrays as list p get email email set subject your password has been changed in i trust email set body string format dear s n you have chosen to change your i trust password user s p get full name mid email  else personnel bean p  personnel dao factory get personnel mid email email  email email set from no reply itrust com email set to list arrays as list p get email email set subject your password has been changed in i trust email set body string format dear s n you have chosen to change your i trust password user s p get full name mid email   validate password string password string confirm password form validation exception  error list error list  error list password  null  equals password  error list add if not null password cannot be empty   password equals confirm password error list add if not null passwords don t match validation format password get regex matcher password matches  error list add if not null password must be in the following format   validation format password get description   error list has errors form validation exception error list  