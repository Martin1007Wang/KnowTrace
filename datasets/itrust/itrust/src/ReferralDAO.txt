referral dao  dao factory factory referral bean loader referral loader verbose referral bean loader verbose loader referral dao dao factory factory  this factory  factory referral loader  referral bean loader verbose loader  verbose referral bean loader  list referral bean get referrals from ov long ovid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where ov id   ps set long 1 ovid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals sent from long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where sender id   ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   referral bean get referral long id db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where id   ps set long 1 id result set rs  ps execute query if rs next referral loader load single rs  else null   sql exception e  e print stack trace db exception e   db util close connection conn ps   set referral message long message id referral id db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement insert into referral message message id referral id values   ps set long 1 message id ps set long 2 referral id ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps  true  is referral message long message id db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referral message where message id   ps set long 1 message id result set rs  ps execute query if rs next rs get long 2  else 0   sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals sent to long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where receiver id   ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals for receiving hcp long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where receiver id   order by priority code asc ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals for patient long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where patient id   order by viewed by patient priority code asc ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals for receiving hcp unread long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where receiver id   and viewed by hcp  false ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list referral bean get referrals for patient unread long mid db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement select  from referrals where patient id   and viewed by patient  false ps set long 1 mid result set rs  ps execute query referral loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   edit referral referral bean r db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement update referrals set patient id sender id receiver id  referral details ovid viewed by patient viewed by hcp priority code where id referral loader load parameters ps r ps set long 9 r get id ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps   add referral referral bean r db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement insert into referrals patient id sender id receiver id  referral details ovid viewed by patient viewed by hcp priority code time stamp   values now ps  referral loader load parameters ps r ps execute update db util get last insert conn  sql exception e  e print stack trace db exception e   db util close connection conn ps   remove referral long id db exception  connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement delete from referrals where id  ps set long 1 id ps execute update  sql exception e  e print stack trace db exception e   db util close connection conn ps   referral list query  dao factory factory userid hash map string string sort columns referral list query dao factory factory userid  this factory  factory this userid  userid sort columns  hash map string string sort columns put patient name concat patients last name   patients first name sort columns put receiver name concat preceiver last name preceiver first name sort columns put sender name concat psender last name psender first name sort columns put timestamp referrals timestamp sort columns put priority referrals priority code  list verbose referral bean doquery string sort field sort direction dir db exception  string stmt  select   concat psender first name psender last name as sender name   concat preceiver first name preceiver last name as receiver name   referrals   officevisits visit date   concat patients first name patients last name as patient name   from   referrals   personnel as psender   personnel as preceiver   patients   officevisits   where   referrals sender id psender mid   and referrals receiver id preceiver mid   and referrals patient id patients mid   and referrals ovid officevisits id  stmt  string format and s   get user field stmt  build sort sort field dir connection conn  null prepared statement ps  null  conn  factory get connection ps  conn prepare statement stmt ps set long 1 get user id result set rs  ps execute query verbose loader load list rs  sql exception e  e print stack trace db exception e   db util close connection conn ps   list verbose referral bean query string sort field sort direction dir db exception  list verbose referral bean beans  doquery sort field dir beans  string get user field get user id  userid  string build sort string sort field sort direction dir  string sortexp  sort columns get sort field string format order by s s  sortexp dir   sender referral list query referral list query  sender referral list query dao factory factory userid  super factory userid  override string get user field  referrals sender id   receiver referral list query referral list query  receiver referral list query dao factory factory userid  super factory userid  override string get user field  referrals receiver id   patient referral list query referral list query  patient referral list query dao factory factory userid  super factory userid  override string get user field  referrals patient id   referral list query get sender query long mid  sender referral list query this factory mid  referral list query get receiver query long mid  receiver referral list query this factory mid  referral list query get patient query long pid  patient referral list query this factory pid  